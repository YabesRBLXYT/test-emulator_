<!DOCTYPE html>
<html>
<head>
    <title>GBA GameCenter</title>
    <meta charset="UTF-8">
    <!-- Required Scripts -->
    <script src="IodineGBA/includes/TypedArrayShim.js"></script>
    <script src="IodineGBA/core/Cartridge.js"></script>
    <script src="IodineGBA/core/DMA.js"></script>
    <script src="IodineGBA/core/Emulator.js"></script>
    <script src="IodineGBA/core/Graphics.js"></script>
    <script src="IodineGBA/core/RunLoop.js"></script>
    <script src="IodineGBA/core/Memory.js"></script>
    <script src="IodineGBA/core/IRQ.js"></script>
    <script src="IodineGBA/core/JoyPad.js"></script>
    <script src="IodineGBA/core/Serial.js"></script>
    <script src="IodineGBA/core/Sound.js"></script>
    <script src="IodineGBA/core/Timer.js"></script>
    <script src="IodineGBA/core/Wait.js"></script>
    <script src="IodineGBA/core/CPU.js"></script>
    <script src="IodineGBA/core/Saves.js"></script>
    <script src="IodineGBA/core/sound/FIFO.js"></script>
    <script src="IodineGBA/core/sound/Channel1.js"></script>
    <script src="IodineGBA/core/sound/Channel2.js"></script>
    <script src="IodineGBA/core/sound/Channel3.js"></script>
    <script src="IodineGBA/core/sound/Channel4.js"></script>
    <script src="IodineGBA/core/CPU/ARM.js"></script>
    <script src="IodineGBA/core/CPU/THUMB.js"></script>
    <script src="IodineGBA/core/CPU/CPSR.js"></script>
    <script src="IodineGBA/core/graphics/Renderer.js"></script>
    <script src="IodineGBA/core/graphics/RendererProxy.js"></script>
    <script src="IodineGBA/core/graphics/BGTEXT.js"></script>
    <script src="IodineGBA/core/graphics/BG2FrameBuffer.js"></script>
    <script src="IodineGBA/core/graphics/BGMatrix.js"></script>
    <script src="IodineGBA/core/graphics/AffineBG.js"></script>
    <script src="IodineGBA/core/graphics/ColorEffects.js"></script>
    <script src="IodineGBA/core/graphics/Mosaic.js"></script>
    <script src="IodineGBA/core/graphics/OBJ.js"></script>
    <script src="IodineGBA/core/graphics/OBJWindow.js"></script>
    <script src="IodineGBA/core/graphics/Window.js"></script>
    <script src="IodineGBA/core/graphics/Compositor.js"></script>
    <script src="IodineGBA/core/memory/DMA0.js"></script>
    <script src="IodineGBA/core/memory/DMA1.js"></script>
    <script src="IodineGBA/core/memory/DMA2.js"></script>
    <script src="IodineGBA/core/memory/DMA3.js"></script>
    <script src="IodineGBA/core/cartridge/SaveDeterminer.js"></script>
    <script src="IodineGBA/core/cartridge/SRAM.js"></script>
    <script src="IodineGBA/core/cartridge/FLASH.js"></script>
    <script src="IodineGBA/core/cartridge/EEPROM.js"></script>
    <!-- Add your webpage scripts below -->
    <script src="user_scripts/XAudioJS/swfobject.js"></script>
    <script src="user_scripts/XAudioJS/resampler.js"></script>
    <script src="user_scripts/XAudioJS/XAudioServer.js"></script>
    <script src="user_scripts/IodineGBAROMLoadGlueCode.js"></script>
    <script src="user_scripts/IodineGBAJoyPadGlueCode.js"></script>
    <script src="user_scripts/IodineGBASavesGlueCode.js"></script>
    <script src="user_scripts/IodineGBAGraphicsGlueCode.js"></script>
    <script src="user_scripts/IodineGBAAudioGlueCode.js"></script>
    <script src="user_scripts/IodineGBACoreGlueCode.js"></script>
    <script src="user_scripts/base64.js"></script>
    <link rel="stylesheet" href="user_css/main.css">
</head>
<body>
    <canvas id="emulator_target" width="240px" height="160px"></canvas>
    <span id="tempMessage"></span>

    <!-- Kontrol GBA -->
    <div id="controls">
        <div id="dpad">
            <button id="up">Up</button>
            <button id="down">Down</button>
            <button id="left">Left</button>
            <button id="right">Right</button>
        </div>
        <div id="buttons">
            <button id="A">A</button>
            <button id="B">B</button>
            <button id="L">L</button>
            <button id="R">R</button>
            <button id="Start">Start</button>
            <button id="Select">Select</button>
        </div>
    </div>

    <script>
        // Menghubungkan tombol ke input emulator
        const buttonMap = {
            'up': 38,        // Arrow Up
            'down': 40,      // Arrow Down
            'left': 37,      // Arrow Left
            'right': 39,     // Arrow Right
            'A': 88,         // X key
            'B': 90,         // Z key
            'L': 81,         // Q key
            'R': 69,         // E key
            'Start': 13,     // Enter key
            'Select': 32     // Space key
        };

        function sendKeyEvent(buttonId, keyDown) {
            const event = new KeyboardEvent(keyDown ? 'keydown' : 'keyup', { keyCode: buttonMap[buttonId] });
            document.dispatchEvent(event);
        }

        document.querySelectorAll('#controls button').forEach(button => {
            button.addEventListener('mousedown', () => sendKeyEvent(button.id, true));
            button.addEventListener('mouseup', () => sendKeyEvent(button.id, false));
        });

        // Untuk touchscreen support (optional)
        document.querySelectorAll('#controls button').forEach(button => {
            button.addEventListener('touchstart', (event) => {
                event.preventDefault();
                sendKeyEvent(button.id, true);
            });
            button.addEventListener('touchend', (event) => {
                event.preventDefault();
                sendKeyEvent(button.id, false);
            });
        });
    </script>

    <style>
        #controls {
            display: flex;
            justify-content: space-around;
            margin-top: 10px;
        }

        #dpad, #buttons {
            display: flex;
            flex-direction: column;
        }

        button {
            width: 60px;
            height: 60px;
            margin: 5px;
            font-size: 18px;
        }

        #dpad {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #buttons {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #up, #down, #left, #right {
            background-color: lightgray;
        }

        #A, #B, #L, #R, #Start, #Select {
            background-color: lightblue;
        }
    </style>
</body>
</html>
